# For on_actions launched by the code itself.

# Root = Country
on_monthly_pulse_country = {
	events = {
		lds_migration.5
		lds_migration.7
		lds_migration.8
	}
	random_events = {
	}
}

on_yearly_pulse_country = {
	random_events = {
	}
}

on_yearly_pulse_country = {
	random_events = {
	}
}
on_half_yearly_pulse_country = {
	random_events = {
	}
}
on_five_year_pulse_country = {
	events = {
	}
}


on_decade_pulse_country = {
	random_events = {
	}
}

# Root = Character
on_monthly_pulse_character = {}
on_yearly_pulse_character = {}
on_half_yearly_pulse_character = {}
on_five_year_pulse_character = {}
on_decade_pulse_character = {}

# Root = State
on_monthly_pulse_state = {}
on_half_yearly_pulse_state = {}
on_yearly_pulse_state = {
	random_events = {}
	on_actions = {}
}
on_five_year_pulse_state = {}
on_decade_pulse_state = {}


# Root = state
on_state_incorporation = {
	on_actions = {
		if = {
			limit = {
				ROOT.owner = c:USA
			}
			star_counter
		}
	}
}

star_counter = {
	c:USA = {
		set_variable = {
			name = flag_stars_var
			value = 0
		}
		every_scope_state = {
			limit = {
				is_incorporated = yes
				NOT = { has_variable = usa_state_flag_block }
			}
			c:USA = {
				change_variable = {
					name = flag_stars_var
					add = 1
				}
			}
		}
		every_scope_state = {
			limit = {
				is_incorporated = yes
				OR = {
					state_region = STATE_MARYLAND
					state_region = STATE_SOUTH_DAKOTA
					state_region = STATE_MONTANA
					state_region = STATE_VERACRUZ
					state_region = STATE_YUCATAN
					state_region = STATE_ZACATECAS
					state_region = STATE_RIO_DE_JANERIO
					state_region = STATE_SANTA_FE
					state_region = STATE_PATAGONIA
					state_region = STATE_CHACO
					state_region = STATE_JUJUY
				}
			}
			c:USA = {
				change_variable = {
					name = flag_stars_var
					add = 1
				}
			}
		}
		every_scope_state = {
			limit = {
				is_incorporated = yes
				OR = {
					state_region = STATE_NEW_BRUNSWICK
					state_region = STATE_RIO_GRANDE
					state_region = STATE_JALISCO
					state_region = STATE_MEXICO
					state_region = STATE_BAJIO
					state_region = STATE_PERNAMBUCO
					state_region = STATE_RIO_NEGRO
				}
			}
			c:USA = {
				change_variable = {
					name = flag_stars_var
					add = 2
				}
			}
		}
		every_scope_state = {
			limit = {
				is_incorporated = yes
				OR = {
					state_region = STATE_TUCUMAN
				}
			}
			c:USA = {
				change_variable = {
					name = flag_stars_var
					add = 3
				}
			}
		}
		every_scope_state = {
			limit = {
				is_incorporated = yes
				OR = {
					state_region = STATE_MASSACHUSETS
				}
			}
			c:USA = {
				change_variable = {
					name = flag_stars_var
					add = 5
				}
			}
		}
	}
}

# Root = Releasing Country
# scope:target = Released Country
on_country_released_as_independent = {
	on_actions = {
		new_country_ideology_assignment
	}
}

# Root = Releasing Country
# scope:target = Released Country
on_country_released_as_own_subject = {
	on_actions = {
		new_country_ideology_assignment
	}
}

# Root = Releasing Country
# scope:target = Released Country
on_country_released_as_overlord_subject = {
	on_actions = {
		new_country_ideology_assignment
	}
}

# Root = Country
# scope:target = Uprising country
on_revolution_start = {
	on_actions = {
		new_country_ideology_assignment
	}
}

new_country_ideology_assignment = {
	effect = {
		scope:target = {
			if = {
				limit = {
					country_has_state_religion = rel:theravada
				}
				ig:ig_devout2 = {
					remove_ideology = ideology_evangelist
					add_ideology = ideology_buddhist_pacifism
				}
			}
			if = {
				limit = {
					country_has_state_religion = rel:vajrayana
				}
				ig:ig_devout2 = {
					remove_ideology = ideology_evangelist
					add_ideology = ideology_buddhist_pacifism
				}
			}
			if = {
				limit = {
					country_has_state_religion = rel:mahayana
				}
				ig:ig_devout2 = {
					remove_ideology = ideology_evangelist
					add_ideology = ideology_buddhist_pacifism
				}
			}
			if = {
				limit = {
					country_has_state_religion = rel:lds
				}
				ig:ig_devout = {
					remove_ideology = ideology_moralist
					remove_ideology = ideology_patriarchal
					add_ideology = ideology_agrarian
					add_ideology = ideology_theodemocratic
				}
				ig:ig_industrialists = {
					remove_ideology = ideology_laissez_faire
					add_ideology = ideology_laissez_faire_secular
				}
				ig:ig_landowners = {
					remove_ideology = ideology_paternalistic
					add_ideology = ideology_republican_paternalistic
				}
			}
			if = {
				limit = {
					exists = c:TUR
					c:TUR = scope:target
				}
				ig:ig_devout2 = {
					remove_ideology = ideology_evangelist
					add_ideology = ideology_ottomanist
				}
			}
			if = {
				limit = {
					is_country_type = colonial
					NOT = {
						exists = c:BRZ
						c:BRZ = scope:target
					}
				}
				ig:ig_petty_bourgeoisie = {
					remove_ideology = ideology_reactionary
					add_ideology = ideology_nativist
				}
			}
			if = {
				limit = {
					AND = {
						OR = {
							country_has_primary_culture = cu:yankee
							country_has_primary_culture = cu:dixie
							country_has_primary_culture = cu:afro_american
							country_has_primary_culture = cu:mormon
							country_has_primary_culture = cu:british
							country_has_primary_culture = cu:scottish
							country_has_primary_culture = cu:welsh
							country_has_primary_culture = cu:australian
							country_has_primary_culture = cu:anglo_canadian
						}
						NOT = {
							C:BIC = scope:target
						}
					}
				}
				ig:ig_rural_folk = {
					remove_ideology = ideology_agrarian
					add_ideology = ideology_yeomanism
				}
			}
		}
	}
}